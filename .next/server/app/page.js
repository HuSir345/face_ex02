(()=>{var e={};e.id=931,e.ids=[931],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},2953:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var a=r(7096),s=r(6132),l=r(7284),n=r.n(l),i=r(2564),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3982)),"D:\\Cursor\\face2exchange\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,5345)),"D:\\Cursor\\face2exchange\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\Cursor\\face2exchange\\app\\page.tsx"],u="/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5054:(e,t,r)=>{Promise.resolve().then(r.bind(r,176))},176:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Home});var a=r(784),s=r(9885),l=r(2451),n=r.n(l);function ProgressBar({progress:e}){return a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-4",children:a.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500",style:{width:`${e}%`}})})}function ImageUploader({onProcess:e,status:t,onImageChange:r}){let[l,i]=(0,s.useState)([]),[o,c]=(0,s.useState)(0),handleImageChange=(e,t)=>{let a=e.target.files?.[0];if(!a)return;if(!a.type.startsWith("image/")){alert("请上传图片文件");return}let s=new FileReader;s.onload=e=>{let s=[...l];s[t]={url:e.target?.result,file:a},i(s),r?.()},s.readAsDataURL(a)},handleSubmit=async()=>{if(!l[0]||!l[1]){alert("请上传两张图片");return}c(0);let t=setInterval(()=>{c(e=>e>=95?(clearInterval(t),e):Math.min(95,e+Math.max(1,(100-e)/20)))},200);try{await e(l[0].file,l[1].file),c(100)}catch(e){clearInterval(t),c(0)}},d=["上传一张脸图","上传一张被替换的脸"];return(0,a.jsxs)("div",{className:"space-y-8",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[0,1].map(e=>(0,a.jsxs)("div",{className:"relative",children:[a.jsx("input",{type:"file",accept:"image/*",onChange:t=>handleImageChange(t,e),className:"hidden",id:`image-input-${e}`}),a.jsx("label",{htmlFor:`image-input-${e}`,className:"block w-full aspect-square border-2 border-dashed rounded-lg cursor-pointer hover:border-gray-400 transition-colors",children:l[e]?a.jsx(n(),{src:l[e].url,alt:`预览图 ${e+1}`,fill:!0,className:"object-cover rounded-lg"}):a.jsx("div",{className:"h-full flex items-center justify-center",children:a.jsx("span",{className:"text-gray-500 text-lg font-bold",children:d[e]})})})]},e))}),"processing"===t&&a.jsx(ProgressBar,{progress:o}),a.jsx("button",{onClick:handleSubmit,disabled:"processing"===t||!l[0]||!l[1],className:"w-full py-3 px-4 bg-blue-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-700 transition-colors",children:"processing"===t?"处理中...":"开始合成"})]})}function ResultDisplay({imageUrl:e}){return(0,a.jsxs)("div",{className:"mt-12 space-y-4",children:[a.jsx("h2",{className:"text-2xl text-center",style:{fontFamily:"'Comic Sans MS', 'Chalkboard SE', 'Marker Felt', sans-serif",background:"linear-gradient(45deg, #FF69B4, #FF1493)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",textShadow:"1px 1px 2px rgba(0,0,0,0.1)",fontWeight:"bold"},children:"换脸后都说好 ✨"}),a.jsx("div",{className:"relative aspect-square w-full max-w-2xl mx-auto",children:a.jsx(n(),{src:e,alt:"合成结果",fill:!0,className:"object-contain"})}),a.jsx("button",{onClick:()=>{window.open(e,"_blank")},className:"block w-full max-w-md mx-auto py-3 px-4 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors",children:"下载图片"})]})}function Home(){let[e,t]=(0,s.useState)("idle"),[r,l]=(0,s.useState)(null),[n,i]=(0,s.useState)(null),handleProcess=async(e,r)=>{try{t("processing"),i(null);let a=new FormData;a.append("image1",e),a.append("image2",r);let s=await fetch("/api/merge",{method:"POST",body:a}),n=await s.json();if(!s.ok)throw Error(n.error||"处理失败");l(n.resultUrl),t("success")}catch(e){console.error("处理错误:",e),i(e.message||"处理失败"),t("error")}};return a.jsx("main",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto py-12 px-4",children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold text-center mb-8",children:["一起玩",a.jsx("span",{className:"inline-block px-2 py-1 mx-1 bg-blue-600 text-white rounded-lg transform hover:scale-105 transition-transform",children:"换脸"})]}),a.jsx(ImageUploader,{onProcess:handleProcess,status:e,onImageChange:()=>{l(null),i(null),t("idle")}}),n&&a.jsx("div",{className:"mt-4 p-4 bg-red-100 text-red-700 rounded-lg",children:n}),r&&a.jsx(ResultDisplay,{imageUrl:r})]})})}},3982:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>o});var a=r(5153);let s=(0,a.createProxy)(String.raw`D:\Cursor\face2exchange\app\page.tsx`),{__esModule:l,$$typeof:n}=s,i=s.default,o=i}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[472,837,55],()=>__webpack_exec__(2953));module.exports=r})();